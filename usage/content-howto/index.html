
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://stackhpc.github.io/stackhpc-release-train/usage/content-howto/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-8.5.10">
    
    
      
        <title>Content management HOWTO - StackHPC Release Train</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage-content-management-howto" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="StackHPC Release Train" class="md-header__button md-logo" aria-label="StackHPC Release Train" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            StackHPC Release Train
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Content management HOWTO
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/stackhpc/stackhpc-release-train/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="StackHPC Release Train" class="md-nav__button md-logo" aria-label="StackHPC Release Train" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    StackHPC Release Train
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stackhpc/stackhpc-release-train/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Content management HOWTO
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Content management HOWTO
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#update-package-repositories" class="md-nav__link">
    Update package repositories
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-a-new-package-repository" class="md-nav__link">
    Add a new package repository
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-kolla-container-images" class="md-nav__link">
    Update Kolla container images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-a-new-kolla-container-image" class="md-nav__link">
    Add a new Kolla container image
  </a>
  
    <nav class="md-nav" aria-label="Add a new Kolla container image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up-builds-for-the-image" class="md-nav__link">
    Set up builds for the image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-test-pulp-syncing-for-the-image" class="md-nav__link">
    Set up Test Pulp syncing for the image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-and-consume-the-image" class="md-nav__link">
    Build and consume the image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-client-pulp-syncing-for-the-image" class="md-nav__link">
    Set up client Pulp syncing for the image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../content-workflows/" class="md-nav__link">
        Content management workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../access/" class="md-nav__link">
        Access control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../source-code-ci/" class="md-nav__link">
        Source code CI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../github-organisation-management/" class="md-nav__link">
        GitHub Organisation Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../secrets/" class="md-nav__link">
        Secrets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notifications/" class="md-nav__link">
        Notifications
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Operations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Operations" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/ark/" class="md-nav__link">
        Ark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/test-pulp/" class="md-nav__link">
        Test Pulp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/github/" class="md-nav__link">
        GitHub
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#update-package-repositories" class="md-nav__link">
    Update package repositories
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-a-new-package-repository" class="md-nav__link">
    Add a new package repository
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-kolla-container-images" class="md-nav__link">
    Update Kolla container images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-a-new-kolla-container-image" class="md-nav__link">
    Add a new Kolla container image
  </a>
  
    <nav class="md-nav" aria-label="Add a new Kolla container image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up-builds-for-the-image" class="md-nav__link">
    Set up builds for the image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-test-pulp-syncing-for-the-image" class="md-nav__link">
    Set up Test Pulp syncing for the image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-and-consume-the-image" class="md-nav__link">
    Build and consume the image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-client-pulp-syncing-for-the-image" class="md-nav__link">
    Set up client Pulp syncing for the image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/stackhpc/stackhpc-release-train/edit/master/docs/usage/content-howto.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="usage-content-management-howto">Usage - content management HOWTO<a class="headerlink" href="#usage-content-management-howto" title="Permanent link">&para;</a></h1>
<p>While the <a href="../content-workflows/">content management workflows</a> documentation provides information on each of the workflows provided by the release train, it does not give instructions for how to compose them to achieve common tasks.
That is the aim of this page.</p>
<h2 id="update-package-repositories">Update package repositories<a class="headerlink" href="#update-package-repositories" title="Permanent link">&para;</a></h2>
<p>Update one or more package repositories to a new version, then build new Kolla container images from those repositories.</p>
<p>If using Yoga release or earlier:</p>
<ul>
<li><a href="../content-workflows/#syncing-package-repositories">Sync package repositories</a> (optional: runs nightly as a scheduled GitHub Action)</li>
<li><a href="../content-workflows/#updating-package-repository-versions-in-kayobe-configuration">Update Kayobe repository versions</a></li>
<li><a href="../content-workflows/#building-container-images">Build &amp; push Kolla container images</a></li>
<li><a href="../content-workflows/#updating-container-image-tags-in-kayobe-configuration-yoga-release-and-earlier">Update Kayobe container image tags</a></li>
<li>Test</li>
<li>Review &amp; merge Kayobe configuration changes</li>
<li><a href="../content-workflows/#promoting-container-images-yoga-release-and-earlier">Promote container images</a></li>
</ul>
<p>If using Zed release onwards:</p>
<ul>
<li><a href="../content-workflows/#syncing-package-repositories">Sync package repositories</a> (optional: runs nightly as a scheduled GitHub Action)</li>
<li><a href="../content-workflows/#updating-package-repository-versions-in-kayobe-configuration">Update Kayobe repository versions</a></li>
<li><a href="../content-workflows/#building-container-images">Build &amp; push Kolla container images</a></li>
<li><a href="../content-workflows/#updating-container-image-tags-in-kayobe-configuration-zed-release-onwards">Update Kayobe container image tags</a></li>
<li>Test</li>
<li>Review &amp; merge Kayobe configuration changes</li>
<li><a href="../content-workflows/#promoting-container-images-zed-release-onwards">Promote container images</a> (happens automatically)</li>
</ul>
<h2 id="add-a-new-package-repository">Add a new package repository<a class="headerlink" href="#add-a-new-package-repository" title="Permanent link">&para;</a></h2>
<p>Add one or more new package repositories to the release train, then add them to the Kayobe configuration and build new Kolla container images from those repositories.</p>
<p>If using Yoga release or earlier:</p>
<ul>
<li><a href="../content-workflows/#add-new-package-repositories-to-release-train">Add new package repositories to Release Train</a></li>
<li><a href="../content-workflows/#syncing-package-repositories">Sync package repositories</a> (optional: runs nightly as a scheduled GitHub Action)</li>
<li><a href="../content-workflows/#adding-package-repositories-in-kayobe-configuration">Add package repositories to StackHPC Kayobe Configuration</a></li>
<li><a href="../content-workflows/#updating-package-repository-versions-in-kayobe-configuration">Update Kayobe repository versions</a></li>
<li><a href="../content-workflows/#building-container-images">Build &amp; push Kolla container images</a></li>
<li><a href="../content-workflows/#updating-container-image-tags-in-kayobe-configuration-yoga-release-and-earlier">Update Kayobe container image tags</a></li>
<li>Test</li>
<li>Review &amp; merge Kayobe configuration changes</li>
<li><a href="../content-workflows/#promoting-container-images-yoga-release-and-earlier">Promote container images</a></li>
</ul>
<p>If using Zed release onwards:</p>
<ul>
<li><a href="../content-workflows/#add-new-package-repositories-to-release-train">Add new package repositories to Release Train</a></li>
<li><a href="../content-workflows/#syncing-package-repositories">Sync package repositories</a> (optional: runs nightly as a scheduled GitHub Action)</li>
<li><a href="../content-workflows/#adding-package-repositories-in-kayobe-configuration">Add package repositories to StackHPC Kayobe Configuration</a></li>
<li><a href="../content-workflows/#updating-package-repository-versions-in-kayobe-configuration">Update Kayobe repository versions</a></li>
<li><a href="../content-workflows/#building-container-images">Build &amp; push Kolla container images</a></li>
<li><a href="../content-workflows/#updating-container-image-tags-in-kayobe-configuration-zed-release-onwards">Update Kayobe container image tags</a></li>
<li>Test</li>
<li>Review &amp; merge Kayobe configuration changes</li>
<li><a href="../content-workflows/#promoting-container-images-zed-release-onwards">Promote container images</a> (happens automatically)</li>
</ul>
<h2 id="update-kolla-container-images">Update Kolla container images<a class="headerlink" href="#update-kolla-container-images" title="Permanent link">&para;</a></h2>
<p>Update one or more Kolla container images, without updating package repositories.</p>
<p>If using Yoga release or earlier:</p>
<ul>
<li><a href="../content-workflows/#building-container-images">Build &amp; push Kolla container images</a></li>
<li><a href="../content-workflows/#updating-container-image-tags-in-kayobe-configuration-yoga-release-and-earlier">Update Kayobe container image tags</a></li>
<li>Test</li>
<li>Review &amp; merge Kayobe configuration changes</li>
<li><a href="../content-workflows/#promoting-container-images-yoga-release-and-earlier">Promote container images</a></li>
</ul>
<p>If using Zed release onwards:</p>
<ul>
<li><a href="../content-workflows/#building-container-images">Build &amp; push Kolla container images</a></li>
<li><a href="../content-workflows/#updating-container-image-tags-in-kayobe-configuration-zed-release-onwards">Update Kayobe container image tags</a></li>
<li>Test</li>
<li>Review &amp; merge Kayobe configuration changes</li>
<li><a href="../content-workflows/#promoting-container-images-zed-release-onwards">Promote container images</a> (happens automatically)</li>
</ul>
<h2 id="add-a-new-kolla-container-image">Add a new Kolla container image<a class="headerlink" href="#add-a-new-kolla-container-image" title="Permanent link">&para;</a></h2>
<h3 id="set-up-builds-for-the-image">Set up builds for the image<a class="headerlink" href="#set-up-builds-for-the-image" title="Permanent link">&para;</a></h3>
<p>The list of services supported by StackHPC Kayobe configuration is defined via
the feature flags in the
<a href="https://github.com/stackhpc/stackhpc-kayobe-config/blob/stackhpc/2024.1/etc/kayobe/environments/ci-builder/stackhpc-ci.yml">ci-builder</a>
environment. To add a new service, add the relevant feature flag (see
<code>etc/kayobe/kolla.yml</code> for supported flags). For example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">kolla_enable_foo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<p>Create a PR for the change.</p>
<h3 id="set-up-test-pulp-syncing-for-the-image">Set up Test Pulp syncing for the image<a class="headerlink" href="#set-up-test-pulp-syncing-for-the-image" title="Permanent link">&para;</a></h3>
<p>Next, the new images must be added to the <code>kolla_container_images</code> list in
<a href="https://github.com/stackhpc/stackhpc-release-train/blob/main/ansible/inventory/group_vars/all/kolla">stackhpc-release-train</a>.
For example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">kolla_container_images</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">8&lt;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">- foo-api</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">- foo-manager</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">8&lt;</span>
</code></pre></div>
<p>Create a PR for the change.</p>
<h3 id="build-and-consume-the-image">Build and consume the image<a class="headerlink" href="#build-and-consume-the-image" title="Permanent link">&para;</a></h3>
<p>Once the two PRs have been approved and merged, follow the <a href="#update-kolla-container-images">steps
above</a> to build and consume the new images.</p>
<h3 id="set-up-client-pulp-syncing-for-the-image">Set up client Pulp syncing for the image<a class="headerlink" href="#set-up-client-pulp-syncing-for-the-image" title="Permanent link">&para;</a></h3>
<p>Finally, the new images must be added to the <code>stackhpc_pulp_images</code> list in <a href="https://github.com/stackhpc/stackhpc-kayobe-config/blob/stackhpc/2024.1/etc/kayobe/pulp.yml">etc/kayobe/pulp.yml</a>.
This updates the list of images that are synced from Ark to clients' local Pulp service.
This step should be performed last, once the images have been pushed to Ark and promoted, otherwise client container syncs would fail.</p>
<div class="highlight"><pre><span></span><code><span class="nt">stackhpc_pulp_images</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">8&lt;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">- foo-api</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">- foo-manager</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">8&lt;</span>
</code></pre></div>
<p>Create a PR for the change.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../architecture/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Architecture" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Architecture
            </div>
          </div>
        </a>
      
      
        
        <a href="../content-workflows/" class="md-footer__link md-footer__link--next" aria-label="Next: Content management workflows" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Content management workflows
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.sections"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>